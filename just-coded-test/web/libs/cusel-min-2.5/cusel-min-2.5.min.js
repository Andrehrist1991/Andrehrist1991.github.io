function cuselScrollToCurent(c){var d=null;c.find(".cuselOptHover").eq(0).is("span")?d=c.find(".cuselOptHover").eq(0):c.find(".cuselActive").eq(0).is("span")&&(d=c.find(".cuselActive").eq(0));c.find(".jScrollPaneTrack").eq(0).is("div")&&d&&(d=d.position(),c=c.find(".cusel-scroll-pane").eq(0).attr("id"),jQuery("#"+c)[0].scrollTo(d.top))}
function cuselShowList(c){var d=c.parent(".cusel");"none"==c.css("display")?($(".cusel-scroll-wrap").css("display","none"),$(".cuselOpen").removeClass("cuselOpen"),d.addClass("cuselOpen"),c.css("display","block"),d.prop("class").indexOf("cuselScrollArrows"),cuselScrollToCurent(c)):(c.css("display","none"),d.removeClass("cuselOpen"))}
function cuSelRefresh(c){var d=c.refreshEl.split(","),e=d.length,a;for(a=0;a<e;a++){var b=jQuery(d[a]).parents(".cusel").find(".cusel-scroll-wrap").eq(0);b.find(".cusel-scroll-pane").jScrollPaneRemoveCusel();b.css({visibility:"hidden",display:"block"});var f=b.find("span"),k=f.eq(0).outerHeight();f.length>c.visRows?b.css({height:k*c.visRows+"px",display:"none",visibility:"visible"}).children(".cusel-scroll-pane").css("height",k*c.visRows+"px"):b.css({display:"none",visibility:"visible"})}}
function cuSel(c){function d(){jQuery("html").unbind("click");jQuery("html").click(function(a){a=jQuery(a.target);a.attr("id");var b=a.prop("class");if(-1==b.indexOf("cuselText")&&-1==b.indexOf("cuselFrameRight")||-1!=a.parent().prop("class").indexOf("classDisCusel"))-1!=b.indexOf("cusel")&&-1==b.indexOf("classDisCusel")&&a.is("div")?(c=a.find(".cusel-scroll-wrap").eq(0),cuselShowList(c)):a.is(".cusel-scroll-wrap span")&&-1==b.indexOf("cuselActive")?(void 0==a.attr("val")?c=a.text():c=a.attr("val"),
a.parents(".cusel-scroll-wrap").find(".cuselActive").eq(0).removeClass("cuselActive").end().parents(".cusel-scroll-wrap").next().val(c).end().prev().text(a.text()).end().css("display","none").parent(".cusel").removeClass("cuselOpen"),a.addClass("cuselActive"),a.parents(".cusel-scroll-wrap").find(".cuselOptHover").removeClass("cuselOptHover"),-1==b.indexOf("cuselActive")&&a.parents(".cusel").find(".cusel-scroll-wrap").eq(0).next("input").change()):a.parents(".cusel-scroll-wrap").is("div")||jQuery(".cusel-scroll-wrap").css("display",
"none").parent(".cusel").removeClass("cuselOpen");else{var c=a.parent().find(".cusel-scroll-wrap").eq(0);cuselShowList(c)}});jQuery(".cusel").unbind("keydown");jQuery(".cusel").keydown(function(a){if(window.event)var b=window.event.keyCode;else a&&(b=a.which);if(null==b||0==b||9==b)return!0;if(-1!=jQuery(this).prop("class").indexOf("classDisCusel"))return!1;if(40==b)return b=jQuery(this).find(".cuselOptHover").eq(0),b=b.is("span")?b:jQuery(this).find(".cuselActive").eq(0),a=b.next(),a.is("span")&&
(jQuery(this).find(".cuselText").eq(0).text(a.text()),b.removeClass("cuselOptHover"),a.addClass("cuselOptHover"),$(this).find("input").eq(0).val(a.attr("val")),cuselScrollToCurent($(this).find(".cusel-scroll-wrap").eq(0))),!1;if(38==b)return b=$(this).find(".cuselOptHover").eq(0),b=b.is("span")?b:$(this).find(".cuselActive").eq(0),cuselActivePrev=b.prev(),cuselActivePrev.is("span")&&($(this).find(".cuselText").eq(0).text(cuselActivePrev.text()),b.removeClass("cuselOptHover"),cuselActivePrev.addClass("cuselOptHover"),
$(this).find("input").eq(0).val(cuselActivePrev.attr("val")),cuselScrollToCurent($(this).find(".cusel-scroll-wrap").eq(0))),!1;27==b&&(a=$(this).find(".cuselActive").eq(0).text(),$(this).removeClass("cuselOpen").find(".cusel-scroll-wrap").eq(0).css("display","none").end().find(".cuselOptHover").eq(0).removeClass("cuselOptHover"),$(this).find(".cuselText").eq(0).text(a));13==b&&(a=$(this).find(".cuselOptHover").eq(0),a.is("span")?($(this).find(".cuselActive").removeClass("cuselActive"),a.addClass("cuselActive")):
$(this).find(".cuselActive").attr("val"),$(this).removeClass("cuselOpen").find(".cusel-scroll-wrap").eq(0).css("display","none").end().find(".cuselOptHover").eq(0).removeClass("cuselOptHover"),$(this).find("input").eq(0).change());32==b&&$.browser.opera&&(b=$(this).find(".cusel-scroll-wrap").eq(0),cuselShowList(b));if($.browser.opera)return!1});var c=[];jQuery(".cusel").keypress(function(a){if(window.event)var b=window.event.keyCode;else a&&(b=a.which);if(null==b||0==b||9==b)return!0;if(-1!=jQuery(this).prop("class").indexOf("classDisCusel"))return!1;
var d=this;c.push(a);clearTimeout(jQuery.data(this,"timer"));a=setTimeout(function(){var a=[];for(b in c)window.event?a[b]=c[b].keyCode:c[b]&&(a[b]=c[b].which),a[b]=String.fromCharCode(a[b]).toUpperCase();var b=jQuery(d).find("span");var f=b.length,e;for(e=0;e<f;e++){var m=!0,h;for(h in c){var p=b.eq(e).text().charAt(h).toUpperCase();p!=a[h]&&(m=!1)}if(m){jQuery(d).find(".cuselOptHover").removeClass("cuselOptHover").end().find("span").eq(e).addClass("cuselOptHover").end().end().find(".cuselText").eq(0).text(b.eq(e).text());
cuselScrollToCurent($(d).find(".cusel-scroll-wrap").eq(0));c=c.splice;c=[];break}}c=c.splice;c=[]},500);jQuery(this).data("timer",a);if(jQuery.browser.opera&&9!=window.event.keyCode)return!1})}jQuery(c.changedEl).each(function(e){var a=jQuery(this);a.outerWidth();var b=a.prop("class"),f=a.prop("id")?a.prop("id"):"cuSel-"+e;e=a.prop("name");var k=a.val(),g=a.find("option[value='"+k+"']").eq(0),q=g.text(),r=a.prop("disabled"),m=c.scrollArrows,h=a.prop("onchange"),p=a.prop("tabindex"),l=a.prop("multiple");
if(!f||l)return!1;l=a.data("events");var n=[];l&&l.change&&$.each(l.change,function(a,b){n[n.length]=b});r?(classDisCuselText="classDisCuselLabel",classDisCusel="classDisCusel"):classDisCusel=classDisCuselText="";m&&(classDisCusel+=" cuselScrollArrows");g.addClass("cuselActive");g=a.html().replace(/option/ig,"span").replace(/value=/ig,"val=");$.browser&&9>parseInt($.browser.version)&&(g=g.replace(/(val=)(.*?)(>)/g,"$1'$2'$3"));a.replaceWith('<div class="cusel '+b+" "+classDisCusel+'" id=cuselFrame-'+
f+'  tabindex="'+p+'"><div class="cuselFrameRight"></div><div class="cuselText">'+q+'</div><div class="cusel-scroll-wrap"><div class="cusel-scroll-pane" id="cusel-scroll-'+f+'">'+g+'</div></div><input type="hidden" id="'+f+'" name="'+e+'" value="'+k+'" /></div>');h&&jQuery("#"+f).bind("change",h);n.length&&$.each(n,function(a,b){$("#"+f).bind("change",b)});a=jQuery("#cuselFrame-"+f);b=a.find("span");b.eq(0).text()?e=b.eq(0).innerHeight():(e=b.eq(1).innerHeight(),b.eq(0).css("height",b.eq(1).height()));
b.length>c.visRows?a.find(".cusel-scroll-wrap").eq(0).css({height:e*c.visRows+"px",display:"none",visibility:"visible"}).children(".cusel-scroll-pane").css("height",e*c.visRows+"px"):a.find(".cusel-scroll-wrap").eq(0).css({display:"none",visibility:"visible"});a=jQuery("#cusel-scroll-"+f).find("span[addTags]");b=a.length;for(i=0;i<b;i++)a.eq(i).append(a.eq(i).attr("addTags")).removeAttr("addTags");d()});jQuery(".cusel").focus(function(){jQuery(this).addClass("cuselFocus")});jQuery(".cusel").blur(function(){jQuery(this).removeClass("cuselFocus")});
jQuery(".cusel").hover(function(){jQuery(this).addClass("cuselFocus")},function(){jQuery(this).removeClass("cuselFocus")})};